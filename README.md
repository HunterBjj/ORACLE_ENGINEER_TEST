# <p align="center"> ![image](https://github.com/user-attachments/assets/19eaae88-976f-492a-b9a1-d7668771a384) </p>

# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ (PL/SQL / Oracle) –∫–æ–º–ø–∞–Ω–∏–∏ –¶–§–¢

## –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏–π:

1. **–£–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é Oracle**, –∫–æ—Ç–æ—Ä—É—é –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ:
   https://onecompiler.com/plsql/    Oracle PL/SQL, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–∞ –≤–µ—Ä—Å–∏–∏ 23c (23.3.0.0).
3. **–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
4. –ï—Å–ª–∏ –≤—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ —Ä–µ—à–µ–Ω–∏–µ **–Ω–∞–ª–æ–∂–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —É—Å–ª–æ–≤–∏—è –∑–∞–¥–∞—á–∏**, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ **—É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É**, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –≤—ã –ø—Ä–∏–Ω—è–ª–∏ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ.

---

## üß© –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1: –ê–Ω–∞–≥—Ä–∞–º–º—ã

**–£—Å–ª–æ–≤–∏–µ:**  
–î–∞–Ω—ã –¥–≤–µ —Å—Ç—Ä–æ–∫–∏. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞ PL/SQL —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π, —è–≤–ª—è—é—Ç—Å—è –ª–∏ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –∞–Ω–∞–≥—Ä–∞–º–º–∞–º–∏ (—Ç–æ –µ—Å—Ç—å, —Å–æ—Å—Ç–æ—è—Ç –ª–∏ –æ–Ω–∏ –∏–∑ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å–∏–º–≤–æ–ª–æ–≤).

``` sql
CREATE OR REPLACE FUNCTION sort_string(str VARCHAR2) RETURN VARCHAR2 IS
    v_sorted VARCHAR2(4000);
BEGIN
    SELECT LISTAGG(SUBSTR(str, LEVEL, 1), '') WITHIN GROUP (ORDER BY SUBSTR(str, LEVEL, 1))
    INTO v_sorted
    FROM dual
    CONNECT BY LEVEL <= LENGTH(str);
    RETURN v_sorted;
END;
/

CREATE OR REPLACE FUNCTION is_anagram(str1 VARCHAR2, str2 VARCHAR2) RETURN VARCHAR2 IS
BEGIN
    IF LENGTH(str1) != LENGTH(str2) THEN
        RETURN 'NO';
    ELSIF sort_string(LOWER(str1)) = sort_string(LOWER(str2)) THEN
        RETURN 'YES';
    ELSE
        RETURN 'NO';
    END IF;
END;
/

SELECT is_anagram('test', 'test') from dual; 
SELECT is_anagram('test', 'test2') from dual;
```

---

## üß© –ó–∞–¥–∞–Ω–∏–µ ‚Ññ2: 
**–£—Å–ª–æ–≤–∏–µ:**  
–î–∞–Ω—ã —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã: –ù–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Ç—Ä–∏ —É—Å–ª—É–≥–∏, —Å—É–º–º—ã –æ–±–æ—Ä–æ—Ç–æ–≤ –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏. –í—ã–±–æ—Ä–∫—É —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É –∏ —É–±—ã–≤–∞–Ω–∏—é —Å—É–º–º—ã –æ–±–æ—Ä–æ—Ç–∞.

–ü–æ—Å—Ç–∞–≤—â–∏–∫ (delivers)
| –ü–æ–ª–µ   | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                |
| ------ | ---------- | ----------------------- |
| `Id`   | `NUMBER`   | ID –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞           |
| `Name` | `VARCHAR2` | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ |

–£—Å–ª—É–≥–∞ (services)
| –ü–æ–ª–µ      | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
| --------- | ---------- | -------------------------------------------- |
| `Id`      | `NUMBER`   | ID —É—Å–ª—É–≥–∏                                    |
| `Name`    | `VARCHAR2` | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏                          |
| `Deliver` | `NUMBER`   | ID –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (–≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ `DELIVERS.Id`) |

–û–±–æ—Ä–æ—Ç (turns)
| –ü–æ–ª–µ      | –¢–∏–ø           | –û–ø–∏—Å–∞–Ω–∏–µ                                 |
| --------- | ------------- | ---------------------------------------- |
| `Id`      | `NUMBER`      | ID –∑–∞–ø–∏—Å–∏                                |
| `Service` | `NUMBER`      | ID —É—Å–ª—É–≥–∏ (–≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ `SERVICES.Id`) |
| `Turn`    | `NUMBER(9,2)` | –°—É–º–º–∞ –æ–±–æ—Ä–æ—Ç–∞                            |

–î–æ–±–∞–≤–∏–ª:

1. GENERATED BY DEFAULT ON NULL AS IDENTITY ‚Äî —Å–ø–æ—Å–æ–± –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π;

2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ NOT NULL –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è;

3. –ò–∑–º–µ–Ω–∏–ª –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

``` sql
CREATE TABLE delivers (
    id_deliver   NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    deliver_name VARCHAR2(255) NOT NULL
);

CREATE TABLE services (
    id_service     NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    service_name   VARCHAR2(255) NOT NULL,
    deliver        NUMBER NOT NULL,
    CONSTRAINT fk_services_deliver FOREIGN KEY (deliver) REFERENCES delivers(id_deliver)
);

CREATE TABLE turns (
    id_turn NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    service NUMBER NOT NULL,
    turn    NUMBER(9,2) NOT NULL,
    CONSTRAINT fk_turns_service FOREIGN KEY (service) REFERENCES services(id_service)
);

INSERT INTO delivers VALUES (1, 'deliver A');
INSERT INTO delivers VALUES (2, 'deliver B');

INSERT INTO services VALUES (1, 'service 1', 1);
INSERT INTO services VALUES (2, 'service 2', 1);
INSERT INTO services VALUES (3, 'service 3', 1);
INSERT INTO services VALUES (4, 'service 4', 1);
INSERT INTO services VALUES (5, 'service 5', 2);
INSERT INTO services VALUES (6, 'service 6', 2);
INSERT INTO services VALUES (7, 'service 7', 2);

INSERT INTO turns VALUES (1, 1, 1000);
INSERT INTO turns VALUES (2, 2, 2000);
INSERT INTO turns VALUES (3, 3, 3000);
INSERT INTO turns VALUES (4, 4, 400);
INSERT INTO turns VALUES (5, 5, 300);
INSERT INTO turns VALUES (6, 6, 600);
INSERT INTO turns VALUES (7, 7, 700);

SELECT deliver_name, service_name, total_turn
FROM (
  SELECT 
    d.deliver_name,
    s.service_name,
    SUM(t.turn) AS total_turn,
    ROW_NUMBER() OVER (PARTITION BY d.id_deliver ORDER BY SUM(t.turn) DESC) AS row_number
  FROM delivers d
  JOIN services s ON d.id_deliver = s.deliver
  JOIN turns t ON s.id_service = t.service
  GROUP BY d.id_deliver, d.deliver_name, s.service_name
)
WHERE row_number <= 3
ORDER BY deliver_name, total_turn DESC;
```

---

## üß© –ó–∞–¥–∞–Ω–∏–µ ‚Ññ3: 
**–£—Å–ª–æ–≤–∏–µ:**  
–î–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –¥–æ–≥–æ–≤–æ—Ä–∞—Ö. 

–î–æ–≥–æ–≤–æ—Ä—ã (Contracts)
| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                 |
|-------------------|-----------|------------------------------------------------------------------------------------------|
| Id                | Varchar2  | Id –î–æ–≥–æ–≤–æ—Ä–∞                                                                             |
| Date_beg          | date      | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞                                                   |
| Date_end          | date      | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–∏–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)                            |
| Period_type       | Varchar2(2) | –¢–∏–ø –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è, –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è: <br>‚ÄòMM‚Äô - –º–µ—Å—è—Ü (–µ–∂–µ–º–µ—Å—è—á–Ω–æ) <br>‚ÄòQQ‚Äô ‚Äì –∫–≤–∞—Ä—Ç–∞–ª (–µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ) <br>‚ÄòYY‚Äô ‚Äì –≥–æ–¥ (–µ–∂–µ–≥–æ–¥–Ω–æ) |
| summ              | number    | –°—É–º–º–∞ –¥–æ–≥–æ–≤–æ—Ä–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥                                                                |

```
   –†–∞–∑ –≤ –º–µ—Å—è—Ü –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏—Å —Ç–∏–ø–æ–º –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (—Ä–∞–∑ –≤ –≥–æ–¥/–∫–≤–∞—Ä—Ç–∞–ª/–º–µ—Å—è—Ü).
–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–∏–æ–¥ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (–º–µ—Å—è—Ü/–∫–≤–∞—Ä—Ç–∞–ª/–≥–æ–¥) –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ø–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞.
–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å —Ç–∏–ø–æ–º –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è YY —Å—á—ë—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑ –≤ –≥–æ–¥ –≤ —è–Ω–≤–∞—Ä–µ,
–¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å —Ç–∏–ø–æ–º –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è QQ —Å—á—ë—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–≤–∞—Ä—Ç–∞–ª–∞ (—è–Ω–≤–∞—Ä—å, –∞–ø—Ä–µ–ª—å, –∏—é–ª—å, –æ–∫—Ç—è–±—Ä—å),
–¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å —Ç–∏–ø–æ–º –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è MM —Å—á—ë—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –µ–∂–µ–º–µ—Å—è—á–Ω–æ.
–°—É–º–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥ —Ä–∞–≤–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—é –ø–æ–ª—è summ.
   –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–ª –±—ã –ø–æ –∫–∞–∂–¥–æ–º—É –¥–æ–≥–æ–≤–æ—Ä—É –≤—Å–µ —Å—É–º–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –∑–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü –≥–æ–¥–∞.
–°—á–∏—Ç–∞–µ–º, —á—Ç–æ –Ω–∞—á–∞–ª–æ–º (–æ–∫–æ–Ω—á–∞–Ω–∏–µ–º) –ø–µ—Ä–∏–æ–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ(–ø–æ—Å–ª–µ–¥–Ω–µ–µ) —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞/–∫–≤–∞—Ä—Ç–∞–ª–∞/–≥–æ–¥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø–µ—Ä–∏–æ–¥–∞.
 –ï—Å–ª–∏ –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –Ω–µ –∑–∞–¥–∞–Ω–∞, —Å–ª–µ–¥—É–µ—Ç —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –æ–Ω–∞ —Ä–∞–≤–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –¥–Ω—é —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞. 
–°—Ç—Ä–æ–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ:
   Id –î–æ–≥–æ–≤–æ—Ä–∞, —Ç–∏–ø_–ø–µ—Ä–∏–æ–¥–∞, –≥–æ–¥, —Å—É–º–º–∞_—è–Ω–≤–∞—Ä—å, —Å—É–º–º–∞_—Ñ–µ–≤—Ä–∞–ª—å, —Å—É–º–º–∞_–º–∞—Ä—Ç –∏ —Ç.–¥.
```

–î–æ–±–∞–≤–∏–ª:

1. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ NOT NULL –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è;

2. –ü—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Ç–∏–ø –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è.
   
``` sql

CREATE TABLE Contracts (
    Id VARCHAR2(80) PRIMARY KEY,     
    Date_beg DATE NOT NULL,          
    Date_end DATE,                  
    Period_type VARCHAR2(2) CHECK (Period_type IN ('MM', 'QQ', 'YY')),  
    summ NUMBER                   
);


```

–î–ª—è —Ä–µ—à–µ–Ω–∏–µ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏, —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª CTE.

``` sql

```

